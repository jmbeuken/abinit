<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Tutorial PAW2</title>



<hr><h1>ABINIT tutorial, lesson PAW2:</h1>
<h2>Projector Augmented-Wave technique : the generation of atomic
data
files</h2>
<hr><p>This lesson aims at showing how to compute atomic
data files for the
projector-augmented-wave method.
</p><p>You will learn how to generate the atomic data and
what the main
variables are to govern their softness and transferability.
<br>It is supposed you already know how to use <span style="font-weight: bold; font-style: italic;">ABINIT</span>
in the
PAW case<br>
<br>This lesson should take about 1h30. </p>

<script type="text/javascript" src="list_internal_links.js"> </script>
 
<h3><b>Contents of lesson
PAW2 :</b></h3>
<ul> <li><a href="#1">1.</a> The PAW
atomic dataset - introduction</li><li><a href="lesson_paw2.html#2">2.</a>
Use of the generation code</li><li><a href="lesson_paw2.html#3">3.</a>
First (and basic) PAW
dataset for Nickel</li><li><a href="lesson_paw2.html#4">4.</a>
Checking
the sensitivity of results to some parameters</li><li><a href="lesson_paw2.html#5">5.</a> Adjusting partial
waves and projectors</li><li><a href="lesson_paw2.html#6">6.</a>
Examine the logarithmic derivatives</li><li><a href="lesson_paw2.html#7">7.</a> Testing efficiency of
PAW dataset</li><li><a href="lesson_paw2.html#8">8.</a>Calculate physical quantities</li><li><a href="lesson_paw2.html#9">9.</a> The Real Space Optimization (RSO) -
experienced users</li></ul>
<hr><a name="1">&nbsp;</a>
<h3><b>1. The PAW atomic dataset - introduction
</b></h3>The PAW method is based on the definition of
atomic spheres (augmentation regions) of radius <span style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub>
around the
atoms of the system in which a base of atomic partial waves φ<sub>i</sub>,
of
"pseudized" partial waves<span style="position: relative; top: -5pt; left: 6pt;">~</span>φ<sub>i</sub>,
and of projectors<span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>
(dual to<span style="position: relative; top: -5pt; left: 6pt;">~</span>φ<sub>i</sub>)
have to be
defined. This set of partial-waves and projectors functions plus some
additional atomic data are stored in a so-called <i>PAW dataset</i>.
A
PAW dataset has to be generated for each atomic species in order to
reproduce atomic behavior as accurate
as possible while requiring minimal CPU and memory resources in
executing ABINIT for the crystal simulations. These two
constraints are conflicting.<br>The PAW dataset generation is
the purpose of this tutorial.<br>It is done according
the following procedure (<span style="font-style: italic;">all
parameters that define a PAW dataset are in </span><span style="font-weight: bold; font-style: italic;">bold</span>):<br><ol><li><p>Choose
and <span style="font-weight: bold;">define the concerned
chemical
species</span> (name and atomic number).</p>
</li><li><p>Solve the
atomic all-electrons problem in a given atomic configuration. The
atomic problem is solved within the DFT formalism, using an <span style="font-weight: bold;">exchange-correlation
functional</span> and either a Schrödinger (default) or <span style="font-weight: bold;">scalar-relativistic
approximation</span>. It is a spherical problem and it is solved
on
a <span style="font-weight: bold;">radial grid</span>.&nbsp;The
atomic
problem is solved for a given <span style="font-weight: bold;">electronic
configuration</span> that can be an ionized/excited one.</p>
</li><li><p>Choose a set
of electrons that will be considered as frozen around the nucleus (<span style="font-weight: bold;">core
electrons</span>). The others electrons are valence ones and will
be
used in the PAW basis. The <span style="font-weight: bold;">core
density</span> is then
deduced from the core electrons wave functions. A <span style="font-weight: bold;">smooth core
density</span> equal to the core density outside a given <span style="font-style: italic; font-weight: bold;">r</span><sub style="font-style: italic; font-weight: bold;">core</sub>
<span style="font-weight: bold;">matching radius</span>
is computed.</p>
</li><li><p>Choose
the <span style="font-weight: bold;">size of the PAW basis</span>
(number of partial-waves and projectors). Then choose the partial-waves
included in the basis. The later can be <span style="font-weight: bold;">atomic eigen-functions</span>
related to valence electrons (bound states) and/or <span style="font-weight: bold;">additional
atomic functions</span>, solution of the wave equation for a
given <span style="font-style: italic;">l</span>
quantum number at arbitrary <span style="font-weight: bold;">reference
energies</span> (unbound states).</p> </li><li><p>Generate
<span style="font-weight: bold;">pseudo partial-waves</span>
(smooth partial-waves build with a <span style="font-weight: bold;">pseudization
scheme</span>
and equal to partial-waves outside a given <span style="font-style: italic; font-weight: bold;">r</span><sub style="font-style: italic; font-weight: bold;">c</sub><span style="font-weight: bold;">
matching radius</span>) and associated <span style="font-weight: bold;">projector
functions</span>. Pseudo partial-waves are solutions of the PAW
Hamiltonian deduced from the atomic Hamiltonian by pseudizing the
effective potential (a local <span style="font-weight: bold;">pseudopotential
</span>is
built and equal to effective potential outside a <span style="font-style: italic; font-weight: bold;">r</span><sub style="font-style: italic; font-weight: bold;">vloc</sub><span style="font-weight: bold;">
matching radius</span>). Projectors and partial-waves are then
orthogonalized with a chosen <span style="font-weight: bold;">orthogonalization
scheme</span>.</p>
</li><li><p>Build a <span style="font-style: italic;">compensation
charge density</span> used later in order to retrieve the total
charge of the atom. This compensation charge density is located inside
the PAW spheres and based on an analytical <span style="font-weight: bold;">shape function</span>
(which analytic form and <span style="font-weight: bold;">localization
radius </span><span style="font-style: italic; font-weight: bold;">r</span><sub style="font-style: italic; font-weight: bold;">shape</sub>
can be chosen).</p> </li></ol>The user can choose
between two PAW
dataset generators to produce atomic files directly readable by ABINIT.<br>The
first one is the PAW generator <span style="font-weight: bold; font-style: italic;">ATOMPAW</span>
(originally by N. Holzwarth) and the second one is the
<span style="font-weight: bold; font-style: italic;">Ultra-Soft
(US)
generator</span> (originally written by
D. Vanderbilt).
In this tutorial, we concentrate only on&nbsp;<span style="font-style: italic; font-weight: bold;">ATOMPAW</span>.<br>
<p>It is highly recommended to refer to the following papers to
understand correctly the generation of PAW atomic datasets:</p><div style="margin-left: 40px;">
<br>[1] "Projector augmented-wave method, P.E. Blochl, Phys. Rev. B <span style="font-weight: bold;">50</span>,
17953 (1994)
<br>[2] 
"A projector Augmented Wave (PAW) code for electronic structure
calculations, Part I : <span style="font-style: italic;">atompaw</span>
for generating atom-centered functions", N. Holzwarth et al.,
Computer Physics Communications, 329 (2001) (might also be available at http://www.wfu.edu/%7Enatalie/papers/pwpaw/atompaw.pdf)
<br>[3] "From ultrasoft pseudopotentials to
the projector augmented-wave method", G. Kresse, D. Joubert, Phys. Rev.  B 59, 1758 (1999) 
<br>[4]
"Electronic structure packages: two implementations of the Projector
Augmented-Wave (PAW) formalism", M. Torrent et al., Computer Physics
Communications 181, 1862 (2010) (might also be available at http://www.wfu.edu/%7Enatalie/papers/PAWform/PAWformman.sdarticle.pdf)
<br>[5]
"Notes for revised form of atompaw code", by N.  Holzwarth, available at http://www.wfu.edu/%7Enatalie/papers/pwpaw/notes/atompaw/atompawEqns.pdf
</div><br>
<hr><a name="2">&nbsp;</a>
<h3><b>2. Use of the generation code
</b></h3><p><i>Before continuing, you might
consider to work in a different
subdirectory as for the other lessons. Why not "Work_paw2" ?
</i></p>
<p class="MsoNormal" style=""><span style="font-style: italic;"><span style="font-weight: bold;"></span></span>Provided that <span style="font-weight: bold;">ABINIT</span> has been <span style="font-weight: bold;">compiled</span> with the "<span style="font-style: italic; color: rgb(153, 0, 0);">--with-dft-flavor="...+atompaw"</span>"&nbsp;option,
the <span style="font-weight: bold;"></span><span style="font-weight: bold; font-style: italic;">ATOMPAW</span> code is
directly available from command line.<br>
First, just try to type: <span style="color: rgb(51, 51, 255);">atompaw</span><br>if "<span style="font-style: italic;">atompaw vx.y.z</span>" message appears,
everything is fine.<br>Otherwise, you can try "<span style="color: rgb(51, 51, 255);">~abinit_compilation_directory/fallbacks/exports/bin/atompaw-abinit</span>"</p>

<p class="MsoNormal" style="">In any case, in the following, we name <span style="color: rgb(51, 102, 255); font-style: italic;">atompaw</span>
the <span style="font-weight: bold;">ATOMPAW</span> executable<span style="font-style: italic; color: rgb(51, 102, 255);"></span>.</p><br><big><small><span style="text-decoration: underline;">How to use
Atompaw ?</span></small></big><br><ul><li>Edit
an input file in a text editor (content of input explained <a href="lesson_paw2/atompaw-usersguide.pdf">here</a>)</li></ul><ul><li>Run:&nbsp;<span style="font-weight: bold; font-style: italic;">atompaw
&lt; inputfile</span></li></ul><div style="margin-left: 80px;">Partial
waves φ<sub>i</sub>, PS partial waves<span style="position: relative; top: -5pt; left: 6pt;">~</span>φ<sub>i</sub>
and projectors<span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>
are
given in <span style="color: rgb(51, 102, 255);">wfn.i</span>
files.<br>Logarithmic
derivatives from atomic Hamiltonian
and PAW Hamiltonian resolutions are given in <span style="color: rgb(51, 102, 255);">logderiv.l</span>
files.<br>A summary of the atomic all-electrons computation
and PAW dataset properties can be found in the <span style="color: rgb(51, 102, 255);">Atom_name</span>
file <small>(Atom_name is the first parameter of the input file)</small>.<br>Resulting
PAW dataset is contained in: <br><div style="margin-left: 40px;"><span style="color: rgb(51, 102, 255);">Atom_name.XCfunc-paw.abinit </span>file
(specific format for <span style="font-weight: bold;">ABINIT</span>;
present only if requested in <span style="font-style: italic;">inputfile</span>)<br><span style="color: rgb(51, 102, 255);">Atom_name.atomicdata <span style="color: rgb(0, 0, 0);">file</span></span>
(specific format for <span style="font-weight: bold;">PWPAW</span>
code)</div><div style="margin-left: 40px;"><span style="color: rgb(51, 102, 255);">Atom_name.XCfunc.xml</span>
file
(normalized
XML
file according to specifications from <a href="https://wiki.fysik.dtu.dk/gpaw/setups/pawxml.html">https://wiki.fysik.dtu.dk/gpaw/setups/pawxml.html</a>).<br><span style="color: rgb(51, 102, 255);"></span></div></div><span style="font-style: italic;"></span>
<hr style="width: 100%; height: 2px;"><a name="3">&nbsp;</a>
<h3><b>3. First (and basic) PAW dataset for Nickel
</b></h3><p style="margin-bottom: 0in;" align="justify">Our test case
will be <span style="font-weight: bold;">NICKEL</span>
(<span style="font-style: italic;">1s</span><sup style="font-style: italic;">2</sup><span style="font-style: italic;">
2s</span><sup style="font-style: italic;">2</sup><span style="font-style: italic;"> </span><span style="font-style: italic;">2p</span><sup style="font-style: italic;">6</sup><span style="font-style: italic;">
</span><span style="font-style: italic;">3s</span><sup style="font-style: italic;">2</sup><span style="font-style: italic;"> </span><span style="font-style: italic;">3p</span><sup style="font-style: italic;">6</sup><span style="font-style: italic;"> 3d<sup>8</sup> 4s<sup>2</sup></span>
<span style="font-style: italic;">4p</span><sup style="font-style: italic;">0</sup>).</p><span style="color: rgb(153, 0, 0);">In
a first stage, copy a simple input file for ATOMPAW in your working
directory</span> (find it in ~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input1).
Edit this file.<br><p style="margin-top: 0.08in; margin-bottom: 0in;" align="justify" lang="en-US">This file has been built in the following
way:</p><p style="margin-top: 0.08in; margin-bottom: 0in; font-weight: bold; text-decoration: underline;" align="justify" lang="en-US">1-All-electrons
calculation:</p><ul><li>
First line: define the <span style="font-weight: bold;">material</span>
in the first line</li></ul><ul><li>Second line:
choose the <span style="font-weight: bold;">exchange-correlation
functional</span> (<span style="font-style: italic;">LDA-PW</span>
or <span style="font-style: italic;">GGA-PBE</span>)
and select a <span style="font-weight: bold;">scalar-relativistic
wave equation</span> (<span style="font-style: italic;">nonrelativistic</span>
or <span style="font-style: italic;">scalarrelativistic</span>)
and a (2000
points) <span style="font-weight: bold;">logarithmic grid</span>.&nbsp;</li></ul><ul><li>Next
lines: define&nbsp;the&nbsp;<span style="font-weight: bold;">electronic
configuration</span>:</li></ul><div style="margin-left: 40px;"><div style="margin-left: 40px;"><span style="font-style: italic;">How many
electronic states do we
need to include in the computation ?</span><span style="font-style: italic;"><br>Besides the fully and partially
occupied states, it is recommended to add all states that could be
reached by electrons in the solid. </span><span style="font-style: italic;">Here, for Nickel, the 4p state
is concerned. So we decide to add it in the computation.</span></div><p>-
A&nbsp;line
with the maximum <span style="font-style: italic;">n</span>
quantum
number for each electronic shell; here "4 4 3" means <span style="font-style: italic;">4s, 4p, 3d</span>.</p>-
Definition of occupation numbers:<br><div style="margin-left: 40px;">For
each
partially occupied shell enter the occupation number. An excited
configuration may be useful if the PAW dataset is intended for use in a
context where the material is charged (such as oxides). Although, in
our experience, the results are not highly dependent on the chosen
electronic configuration.<br>We choose here the <span style="font-style: italic;">3d<sup>8</sup> 4s<sup>2</sup></span>
<span style="font-style: italic;">4p</span><sup style="font-style: italic;">0</sup> configuration.
Only <span style="font-style: italic;">3d</span>
and <span style="font-style: italic;">4p</span>
shells are partially occupied ("3
2 8" " and "4 1 0" lines). A "0 0 0" ends the occupation section.</div>-
Selection
of <span style="font-weight: bold;">core and valence
electrons</span>
selection: in a first approach, select only electrons from outer
shells as valence. But, if particular thermodynamical conditions are
to be
simulated, it is generally needed to include “semi-core
states” in the set of valence electrons. Semi-core states are
generally needed with transition metal and rare-earth materials. Note
that all wave functions designated as valence electrons will
be used in the partial-wave basis.<br>Core shells are designated
by a "<span style="font-style: italic;">c</span>"
and valence shells by a "<span style="font-style: italic;">v</span>".
All <span style="font-style: italic;">s states</span>
first, then <span style="font-style: italic;">p states</span>
and finally <span style="font-style: italic;">d states</span>.<br>Here:
</div><div style="margin-left: 80px;"><span style="font-style: italic;">c</span><span style="font-style: italic;"><br>c</span><span style="font-style: italic;"><br>c</span><span style="font-style: italic;"><br>v</span><span style="font-style: italic;"><br>c</span><span style="font-style: italic;"><br>c</span><span style="font-style: italic;"></span><span style="font-style: italic;"><br>v<br>v</span></div><div style="margin-left: 40px;">means:</div><div style="margin-left: 80px;"><span style="font-style: italic;">1s core</span><span style="font-style: italic;"><br>2s core</span><span style="font-style: italic;"><br>3s core</span><span style="font-style: italic;"><br>4s valence</span><span style="font-style: italic;"><br>2p core</span><span style="font-style: italic;"><br>3p core</span><span style="font-style: italic;"><br>4p valence</span><br><span style="font-style: italic;">3d
valence</span></div>
<p style="margin-bottom: 0in; font-weight: bold; text-decoration: underline;" align="justify" lang="en-US">Partial-waves basis
generation:</p><ul><li>A line with <span style="font-style: italic;">l</span><sub style="font-style: italic;">max</sub> the <span style="font-weight: bold;">maximum </span><span style="font-style: italic; font-weight: bold;">l</span><span style="font-weight: bold;"> for the partial waves basis</span>.
Here <span style="font-style: italic;">l</span><sub style="font-style: italic;">max</sub>=2.</li><li>A
line with the <span style="font-style: italic; font-weight: bold;">r</span><sub style="font-style: italic; font-weight: bold;">PAW</sub>
radius. Select it to
be slightly less than half the inter-atomic distance in the solid (as a
first choice). Here <span style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub>=2.3 a.u. If only
one radius is input, all others pseudization radii will be equal to <span style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub>
(<span style="font-style: italic;">r</span><sub style="font-style: italic;">c</sub>, <span style="font-style: italic;">r</span><sub style="font-style: italic;">core</sub>, <span style="font-style: italic;">r</span><sub style="font-style: italic;">Vloc</sub>
and <span style="font-style: italic;">r</span><sub style="font-style: italic;">shape</sub>).</li><li>Next
lines:&nbsp;<span style="font-weight: bold;">add
additional partial-waves</span> φ<sub>i </sub>if
needed: choose to
have <span style="font-weight: bold;">2 partial-waves per
angular momentum</span> in the basis (this choice is
not necessarily optimal but this is the most common one; if <span style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub>
is
small enough, 1 partial-wave per <span style="font-style: italic;">l</span>
may suffice). As a first guess, put
all reference energies for additional partial-waves to 0 Rydberg.</li></ul><div style="margin-left: 40px;">Note that for each angular
momentum, valence states already are included in the partial waves
basis. Here <span style="font-style: italic;">4s</span>,
<span style="font-style: italic;">4p</span>
and <span style="font-style: italic;">3d</span>
states already are in the basis<br>For each angular momentum,
first add "y" to add an additional partial wave. Then, next line, put
the value&nbsp;in Rydberg units. Repeat this for each new partial
wave and finally put "n"<br>In the present file,<br><div style="margin-left: 40px;"><span style="font-style: italic;">y</span><span style="font-style: italic;"> <br>0.5 </span><span style="font-style: italic;"><br>n</span></div>means
that an additional <span style="font-style: italic;">s</span>-
partial wave at <span style="font-style: italic;">E</span><sub style="font-style: italic;">ref</sub>=0.5<span style="font-style: italic;"> Ry</span> as been added.<br><div style="margin-left: 40px;"><span style="font-style: italic;">y </span><span style="font-style: italic;"><br>0.</span><span style="font-style: italic;"><br>n</span></div>means
that an additional&nbsp;<span style="font-style: italic;">p</span>-
partial wave at <span style="font-style: italic;">E</span><sub style="font-style: italic;">ref</sub>=0.<span style="font-style: italic;"> Ry</span> has been added.<br><div style="margin-left: 40px;"><span style="font-style: italic;">y</span><span style="font-style: italic;"> <br>0.</span><span style="font-style: italic;"><br>n</span></div>means
that an additional <span style="font-style: italic;">d-</span>
partial wave at <span style="font-style: italic;">E</span><sub style="font-style: italic;">ref</sub>=0.<span style="font-style: italic;"> Ry</span> as been added.<br>Finally,
partial waves basis contains two <span style="font-style: italic;">s-</span>,
two <span style="font-style: italic;">p-</span>&nbsp;
and two <span style="font-style: italic;">d</span>-
partial waves.</div><ul><li>Next line: definition of
the generation <span style="font-weight: bold;">scheme
for pseudo partial waves</span><span style="position: relative; top: -5pt; left: 6pt; font-weight: bold;">~</span><span style="font-weight: bold;">φ</span><sub style="font-weight: bold;">i</sub><span style="font-weight: bold;">,
and of projectors</span><span style="position: relative; top: -5pt; left: 6pt; font-weight: bold;">~</span><span style="font-weight: bold;">p</span><sub style="font-weight: bold;">i</sub>.
We begin here with
a simple scheme (i.e. "Bloechl" scheme, proposed by P. Blöchl in
ref.
[1]). This will probably be changed later to make the PAW dataset more
efficient.</li><li>Next line: generation scheme for local <span style="font-weight: bold;">pseudopotential </span><span style="font-style: italic; font-weight: bold;">V</span><sub style="font-style: italic; font-weight: bold;">loc</sub>.
In order to get PS partial waves, the atomic potential has to be
"pseudized" using an arbitrary pseudization scheme. We choose here a
"<span style="font-style: italic;">Troullier-Martins</span>" using a
wave equation at <span style="font-style: italic;">l</span><sub style="font-style: italic;">loc</sub>=3
and <span style="font-style: italic;">E</span><sub style="font-style: italic;">loc</sub>=0. <span style="font-style: italic;">Ry</span>. As a first
draft, it is always recommended to put <span style="font-style: italic;">l<sub>loc</sub>=1+l</span><sub style="font-style: italic;">max</sub><span style="font-style: italic;">
(</span><span style="font-style: italic;">l</span><sub style="font-style: italic;">max</sub> defined above).</li><li>Next two
lines: a "2" (two) tells <span style="font-weight: bold;">ATOMPAW</span>
to generate PAW dataset for <span style="font-weight: bold;">ABINIT</span>;
the next line contains options for this <span style="font-weight: bold;">ABINIT</span> file. "default" set all
parameters to their default value. </li><li>A
0 (zero) to end the file.</li></ul>
<br><big style="font-weight: bold; color: rgb(153, 0, 0);">At
this
stage,
run atompaw !</big><span style="color: rgb(153, 0, 0);"><br>For
this purpose, simply enter:&nbsp;</span><span style="font-weight: bold; color: rgb(153, 0, 0);">atompaw
&lt;Ni.atompaw.input1</span><br>
Lot of files are produced. We will examine some of them.<br>A
summary of the PAW dataset generation process has been written in a
file
named&nbsp;<span style="color: rgb(51, 102, 255);">Ni</span>
(name
extracted from first line of input file). Open it. It should look like:<br>
<div style="margin-left: 80px; font-family: monospace;">Atom
= Ni Z = 28<br>Perdew
- Burke - Ernzerhof GGA
Log grid -- n,r0,rmax = 2000 2.2810899E-04 8.0000000E+01<br>Scalar
relativistic calculation -- point nucleus<br>all-electron results<br>&nbsp;core
states (zcore) = 18.0000000000000<br>&nbsp;&nbsp; 1
&nbsp;1 &nbsp;0
&nbsp;2.0000000E+00 -6.0358607E+02<br>&nbsp;&nbsp; 2
&nbsp;2
&nbsp;0&nbsp; 2.0000000E+00 -7.2163318E+01<br>&nbsp;&nbsp;
3&nbsp; 3
&nbsp;0&nbsp; 2.0000000E+00 -8.1627107E+00<br>&nbsp;&nbsp;
5 &nbsp;2
&nbsp;1&nbsp; 6.0000000E+00 -6.2083048E+01<br>&nbsp;&nbsp;
6&nbsp; 3
&nbsp;1&nbsp; 6.0000000E+00 -5.2469208E+00<br>valence
states (zvale) =
10.0000000000000<br>&nbsp; &nbsp;4 &nbsp;4
&nbsp;0&nbsp; 2.0000000E+00
-4.1475541E-01<br>&nbsp; &nbsp;7&nbsp; 4 &nbsp;1
&nbsp;0.0000000E+00
-9.0035738E-02<br>&nbsp; &nbsp;8 &nbsp;3 &nbsp;2
&nbsp;8.0000000E+00
-6.5223644E-01<br>evale = -185.182300204924<br>selfenergy
contribution
= 8.13253645212050<br>paw parameters:<br>&nbsp;
&nbsp; lmax = 2<br>&nbsp;
&nbsp; rc &nbsp; = 2.30969849741149<br>&nbsp;
&nbsp; irc &nbsp;= 1445<br>Vloc:
Norm-conserving Troullier-Martins form; l= 3;e= 0.0000E+00<br>Projector
method: Bloechl<br>Sinc^2 compensation charge shape zeroed at rc<br><br>Number
of basis functions 6<br>&nbsp;No.&nbsp; n &nbsp; l
&nbsp;Energy &nbsp;
&nbsp; &nbsp; &nbsp; &nbsp;Cp coeff &nbsp;
&nbsp; &nbsp;Occ<br>&nbsp;
1&nbsp; &nbsp;4 &nbsp; 0 &nbsp;-4.1475541E-01
-9.5091493E+00
2.0000000E+00<br>&nbsp; 2 999 &nbsp; 0 &nbsp; 5.0000000E-01&nbsp;
3.2926940E+00 0.0000000E+00<br>&nbsp; 3 &nbsp; 4
&nbsp; 1
&nbsp;-9.0035738E-02 -8.9594194E+00 0.0000000E+00<br>&nbsp;
4 999
&nbsp; 1 &nbsp; 0.0000000E+00 &nbsp;1.0836820E+01
0.0000000E+00<br>&nbsp;
5 &nbsp; 3 &nbsp; 2 &nbsp;-6.5223644E-01&nbsp;
9.1576176E+00
8.0000000E+00<br>&nbsp; 6 999 &nbsp; 2 &nbsp;
0.0000000E+00
&nbsp;1.3369075E+01 0.0000000E+00<br>&nbsp;evale from
matrix elements
-1.85182309373359203E+02
</div><p style="margin-left: -0.02in; margin-bottom: 0in;" align="justify" lang="en-US">The generated PAW
dataset (contained in&nbsp;<span style="color: rgb(51, 102, 255);">Ni.atomicdata</span>,&nbsp;<span style="color: rgb(51, 102, 255);">Ni.GGA-PBE-paw.abinit</span>
or&nbsp;<span style="color: rgb(51, 102, 255);">Ni.GGA-PBE.xml</span>
file) is a
first draft.<br>Several parameters have
to be adjusted, in order to get accurate results and efficient DFT
calculations.</p><p style="margin-left: -0.02in; margin-bottom: 0in;" align="justify" lang="en-US">Note that only&nbsp;<span style="color: rgb(51, 102, 255);"></span><span style="color: rgb(51, 102, 255);">Ni.GGA-PBE-paw.abinit</span>
file is directly usable by <span style="font-weight: bold;">ABINIT</span>.</p>
<br><hr style="width: 100%; height: 2px;"><a name="4">&nbsp;</a>
<br><h3>4. Checking the sensitivity of results to some
parameters</h3><ul><li><p style="margin-top: 0.08in; margin-bottom: 0in;" align="justify" lang="en-US"> <span style="text-decoration: underline;">The
radial grid:</span></p>
</li></ul><p style="margin-left: 0.45in; margin-bottom: 0in;" align="justify" lang="en-US">Try to select 700 points in the
logarithmic
grid and check if any
noticeable difference in the results appears.<br><span style="color: rgb(153, 0, 0);">You just have to
replace 2000 by 700 in the second line</span> of&nbsp;<span style="color: rgb(51, 102, 255);">Ni.atompaw.input1</span>
file. <span style="color: rgb(153, 0, 0);">Then
run&nbsp;</span><span style="font-weight: bold; color: rgb(153, 0, 0);">atompaw
&lt;Ni.atompaw.input1</span><span style="color: rgb(153, 0, 0);"> again</span>
and look at the &nbsp;<span style="color: rgb(51, 102, 255);">Ni</span>
file:</p><p style="margin-bottom: 0in; margin-left: 0.8634in;" align="justify" lang="en-US"><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;">evale = -185.182300<span style="color: rgb(51, 204, 0);">567432</span><span style="color: rgb(0, 153, 0);"></span></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"></span><span style="font-family: monospace;"><br>evale from matrix
elements
-1.8518230<span style="color: rgb(51, 204, 0);">1887091256</span>E+02</span></p><div style="margin-left: 40px;">As you see, results obtained with
this new
grid are very close to previous ones. We can keep the 700 points grid.</div><p style="margin-left: 40px; color: rgb(153, 0, 0);">You could
decrease
the size of
the grid; by
setting 400 points you should obtain:</p><div style="margin-left: 40px;"><div style="margin-left: 40px;"><span style="font-family: monospace;">
evale = -185.182<span style="color: rgb(51, 204, 0);">294626845</span><span style="color: rgb(0, 153, 0);"></span></span></div><span style="font-family: monospace;"></span></div><div style="margin-left: 80px;"><span style="font-family: monospace;">evale
from matrix elements -1.851823<span style="color: rgb(51, 204, 0);">37214119599</span>E+02</span></div><p style="margin-left: 0.45in; margin-bottom: 0in;" align="justify" lang="en-US">Small grids give PAW dataset with small size
(in kB) and
run faster in <span style="font-weight: bold;">ABINIT</span>, but
accuracy can be affected.</p><p style="margin-bottom: 0in; margin-left: 0.8634in;" align="justify" lang="en-US">- Note that the final <span style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub> value ("rc =
..." in&nbsp;<span style="color: rgb(51, 102, 255);">Ni</span>
file) change with the
grid; just because <span style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub> is adjusted in
order to belong exactly
to the radial grid. By looking in <span style="font-weight: bold;">ATOMPAW</span> <a href="lesson_paw2/atompaw-usersguide.pdf" target="_blank">user's
guide</a>, you
can choose to keep it constant.</p><p style="margin-bottom: 0in; margin-left: 0.8634in;" align="justify" lang="en-US">- Also note that, if the
results are difficult to
get converged (some error produced by <span style="font-weight: bold;">ATOMPAW</span>),
you should try a linear
grid…</p><br><ul style="text-decoration: underline;"><li><p style="margin-top: 0.08in; margin-bottom: 0in;" align="justify" lang="en-US"> The relativistic approximation of the wave
equation:</p>
</li></ul><p style="margin-left: 0.44in; margin-bottom: 0in;" align="justify"><span style="font-style: italic;">Scalar-relativistic</span>
option should give better results than non-relativistic one, but it
sometimes produces difficulties for the convergence of the atomic
problem (either at the all-electrons resolution step or at the PAW
Hamiltonian solution step). If convergence cannot be reached, try a
<span style="font-style: italic;">non-relativistic</span>
calculation (not recommended for high Z materials)</p>
<p><big>For the following, note that you always should 
check the
&nbsp;<span style="color: rgb(51, 102, 255);">Ni</span>
file, especially the values of valence energy ("<span style="font-style: italic;">evale</span>"). You can
find the valence energy computed for the exact atomic problem and the
valence energy computed with the PAW parameters ("<span style="font-style: italic;">evale from matrix
elements</span>"). These two results should be in close agreement!</big></p><br><hr style="width: 100%; height: 2px;"><a name="5">&nbsp;</a>
<br><h3>5. Adjusting partial waves and projectors
</h3><p style="margin-top: 0.08in; margin-bottom: 0in; margin-left: 0.103in;" align="justify"><span style="color: rgb(153, 0, 0);">Examine 
the partial-waves, PS partial-waves and projectors. </span><br> These are 
saved in files named 
<span style="color: rgb(51, 102, 255);">wfni</span>, where 
<span style="font-style: italic;">i</span> ranges over the number of partial
waves used, so 6 in the present example.  Each file contains 4 columns: the radius in 
column 1, the partial wave φ<sub>i</sub> in column 2, 
the PS partial wave<span style="position: relative; top: -5pt; left: 6pt;">~</span>φ<sub>i</sub> in column 3, 
and the projector<span style="position: relative; top: -5pt; left: 6pt;">~</span>
p<sub>i</sub> in column 4. Plot the three curves as a function of radius using a plotting tool of
your choice.</p><p style="margin-top: 0.08in; margin-bottom: 0in; margin-left: 0.103in;" align="justify">Here is the first <span style="font-style: italic;">s</span>- partial wave
/projector of the Ni example:</p><p style="margin-top: 0.08in; margin-bottom: 0in; margin-left: 0.103in; text-align: center;"><img style="width: 434px; height: 446px;" alt="First s partial wave" src="lesson_paw2/wfn1a.jpg"> </p>
<ul><li><p style="margin-top: 0.08in; margin-bottom: 0in;" align="justify">The&nbsp;φ<sub>i</sub>
should meet the<span style="position: relative; top: -5pt; left: 6pt;">~</span>φ<sub>i
</sub>near or after the last maximum (or minimum). If not, it is
preferable to change the value of the matching (pseudization) radius.</p>
</li><li><p style="margin-top: 0.06in; margin-bottom: 0in;" align="justify">The maxima of the 
<span style="position: relative; top: -5pt; left: 6pt;">~</span>φ<sub>i
</sub>and <span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub> functions
should have the same order of magnitude (but need not agree exactly). If not, you can
try to get this in three ways:</p><div style="margin-left: 40px;">-
Change the matching radius for this partial-wave; but this is not
always possible (PAW spheres should not overlap in the solid)...<br>-
Change the pseudopotential scheme (see later).<br>- If there are
two
(or more) partial waves for the angular momentum <span style="font-style: italic;">l</span> under
consideration, decreasing
the magnitude of the projector is possible by displacing the
references energies. Moving the energies away from each other
generally reduces the magnitude of the projectors, but too big a
difference between energies can lead to wrong logarithmic derivatives
(see following section).</div></li></ul><p style="margin-left: 40px;">Example:
plot the <span style="color: rgb(51, 102, 255);">wfn6</span>
file, concerning the second <span style="font-style: italic;">d-</span>
partial wave:</p><div style="text-align: center;"><img style="width: 434px; height: 446px;" alt="2nd d partial wave" src="lesson_paw2/wfn6a.jpg"></div><p style="margin-left: 40px;">This
partial wave has been
generated at <span style="font-style: italic;">E</span><sub style="font-style: italic;">ref</sub>=0 Ry and
orthogonalized with the first <span style="font-style: italic;">d</span>-
partial wave which has an eigenenergy equal to -0.65Ry (see&nbsp;<span style="color: rgb(51, 102, 255);">Ni</span> file).
These two energies are too close and orthogonalization process produces
"high" partial waves.<br><span style="color: rgb(153, 0, 0);">Try
to
replace the reference energy for
the additional </span><span style="font-style: italic; color: rgb(153, 0, 0);">d</span><span style="color: rgb(153, 0, 0);">-
partial wave. For example, put </span><span style="font-style: italic; color: rgb(153, 0, 0);">E</span><sub style="font-style: italic; color: rgb(153, 0, 0);">ref</sub><span style="color: rgb(153, 0, 0);">=1. instead of </span><span style="font-style: italic; color: rgb(153, 0, 0);">E</span><sub style="font-style: italic; color: rgb(153, 0, 0);">ref</sub><span style="color: rgb(153, 0, 0);">=0.</span>
(line 24 of <span style="color: rgb(51, 102, 255);">Ni.atompaw.input1</span>
file). Run <span style="font-weight: bold;">ATOMPAW</span> again and
plot <span style="color: rgb(51, 102, 255);">wfn6</span> file:</p><p style="text-align: center;"><img style="width: 434px; height: 446px;" alt="2nd d partial wave" src="lesson_paw2/wfn6b.jpg"></p><p style="text-align: left; margin-left: 40px;"><big>Now the
PS partial wave and projector&nbsp;have the same order of magnitude
!</big></p><p style="margin-top: 0.08in; margin-bottom: 0in;" align="justify"></p><p style="margin-top: 0.08in; margin-bottom: 0in;" align="justify"><big>Note
again that you should always check
the <span style="font-style: italic;">evale</span>
values in&nbsp;<span style="color: rgb(51, 102, 255);">Ni</span>
file and make sure they are as close as
possible.<br>If not, choices for projectors and/or partial waves
certainly are not judicious.</big></p><br><hr style="width: 100%; height: 2px;"><a name="6">&nbsp;</a>
<br><h3>6. Examine the logarithmic derivatives</h3><p style="margin-top: 0.08in; margin-bottom: 0in;" align="justify"><span style="color: rgb(153, 0, 0);">
Examine the </span><span style="font-style: italic; font-weight: bold; color: rgb(153, 0, 0);">logarithmic
derivatives</span>, i.e., derivatives of an <span style="font-style: italic;">l</span>-state <span style="font-weight: bold;">d(log(</span><span style="font-style: italic; font-weight: bold;">Ψ</span><sub style="font-style: italic; font-weight: bold;">l</sub><span style="font-weight: bold;">(</span><span style="font-style: italic; font-weight: bold;">E</span><span style="font-weight: bold;">))/dE</span> computed
for the exact atomic problem and with the PAW dataset.<br>They are
printed
in the <span style="color: rgb(51, 102, 255);">logderiv.l</span>
files. Each <span style="color: rgb(51, 102, 255);">logderiv.l</span>
file corresponds to angular momentum quantum number <span style="font-style: italic;">l</span>,
and contains three columns of data: the energy,  the logarithmic
derivative of the <span style="font-style: italic;">l</span>-state of the exact atomic problem and
of the pseudized problem.
In our Ni example, <span style="font-style: italic;">l</span>=0, 1
or 2.</p><p style="margin-top: 0.08in; margin-bottom: 0in;" align="justify">The logarithmic derivatives
should have the following properties:</p>
<ul><li><p style="margin-top: 0.08in; margin-bottom: 0in;" align="justify">The
2 curves should be superimposed as much as possible. By construction,
they are superimposed at the two energies corresponding to the two <span style="font-style: italic;">l</span>
partial-waves. If the superimposition is not good enough, the reference
energy for the second <span style="font-style: italic;">l</span>
partial-wave should be changed.</p> </li><li><p style="margin-top: 0.08in; margin-bottom: 0in;" align="justify">Generally
a discontinuity in the logarithmic derivative curve appears at
0&lt;=<span style="font-style: italic;">E</span><sub style="font-style: italic;">0</sub>&lt;=4&nbsp;Rydberg.
A reasonable
choice is to
choose the 2 reference energies so that <span style="font-style: italic;">E</span><sub style="font-style: italic;">0</sub>
is in between.</p>
</li><li><p style="margin-top: 0.08in; margin-bottom: 0in;" align="justify" lang="en-US"> Too close reference energies produce
“hard” projector functions (as previously seen in
section 5). But moving reference
energies away from each other can damage accuracy of logarithmic
derivatives</p></li></ul>Here are the three logarithmic derivative curves
for the current dataset:<br><img src="lesson_paw2/log0a.jpg" alt="l=0 log derivatives" style="width: 434px; height: 446px;"><img src="lesson_paw2/log1a.jpg" alt="l=1 log derivatives" style="width: 434px; height: 446px;"><img src="lesson_paw2/log2a.jpg" alt="l=2 log derivatives" style="width: 434px; height: 446px;"><br><br>As
you can see, except for <span style="font-style: italic;">l</span>=2,
exact and PAW logarithmic derivatives do not match !<br>According
to
the previous remarks, try other values for the references energies of
the <span style="font-style: italic;">s</span>- and
<span style="font-style: italic;">p</span>-
additional partial waves.<br><span style="color: rgb(153, 0, 0);">First,
edit again the </span><span style="color: rgb(51, 102, 255);">Ni.atompaw.input1</span><span style="color: rgb(153, 0, 0);">
file and put </span><span style="font-style: italic; color: rgb(153, 0, 0);">E</span><sub style="font-style: italic; color: rgb(153, 0, 0);">ref</sub><span style="color: rgb(153, 0, 0);">=3Ry for the
additional </span><span style="font-style: italic; color: rgb(153, 0, 0);">s</span><span style="color: rgb(153, 0, 0);">-
state</span> (line 18); <span style="color: rgb(153, 0, 0);">run
ATOMPAW
again</span>. <span style="color: rgb(153, 0, 0);">Plot the </span><span style="color: rgb(51, 102, 255);">logderiv.0</span>
<span style="color: rgb(153, 0, 0);">file</span>.
You should get:<br><div style="text-align: center;"><img src="lesson_paw2/log0b.jpg" alt="l=0 log derivatives" style="width: 434px; height: 446px;"></div><br><span style="color: rgb(153, 0, 0);">Then
put </span><span style="font-style: italic; color: rgb(153, 0, 0);">E</span><sub style="font-style: italic; color: rgb(153, 0, 0);">ref</sub><span style="color: rgb(153, 0, 0);">=4Ry
for the second </span><span style="font-style: italic; color: rgb(153, 0, 0);">p</span><span style="color: rgb(153, 0, 0);">-
state</span> (line
21); <span style="color: rgb(153, 0, 0);">run ATOMPAW again</span>. <span style="color: rgb(153, 0, 0);">Plot
again the </span><span style="color: rgb(51, 102, 255);">logderiv.1</span><span style="color: rgb(153, 0, 0);">
file</span>. You should
get:<br><div style="text-align: center;"><img src="lesson_paw2/log1b.jpg" alt="l=1 log derivatives" style="width: 434px; height: 446px;"></div><div style="text-align: center;"><div style="text-align: left; margin-left: 80px;"><big>Now,
all PAW logarithmic derivatives match with the exact ones in a
reasonable interval.</big></div></div><big><span style="text-decoration: underline;"><br><small>Note: enlarging energy
range of logarithmic derivatives plots</small></span></big><small><br>It
is possible to change the interval of energies used to plot logarithmic
derivatives (default is [-5;5]) and also to compute them at more points
(default is 200). Just add the following keywords at the end of the
SECOND LINE of the input file:<br><span style="color: rgb(0, 102, 0);">logderivrange
-10 10 500</span><br>In the above example <span style="font-weight: bold;">ATOMPAW</span> plots logarithmic
derivatives for energies in [-10;10] at 500 points.</small><br><big><span style="text-decoration: underline;">Additional information
concerning
logarithmic derivatives:</span></big><br>Another
possible problem could be the presence of a discontinuity in the PAW
logarithmic derivative curve at an energy where the exact logarithmic
derivative is continuous.<br>This generally shows the presence of
a
“<span style="font-weight: bold;">ghost state</span>”.<br><ul><li>First,
try to change to value of reference energies; this sometimes
can make the ghost state disappear.</li><li>If not, it can
be useful
to:</li></ul><div style="margin-left: 40px;">*
Change the
pseudopotential scheme. Norm-conserving pseudopotentials are
sometimes so deep (attractive near <span style="font-style: italic;">r</span>=0)
that they produce ghost states.<br><div style="margin-left: 40px;">A
first solution is to change the<span style="font-style: italic;"></span>
quantum number used to generate the
norm-conserving pseudopotential. But this is generally not sufficient.<br>A
second solution is to select an "ultrasoft" pseudopotential, freeing
the norm conservation constraint (simply replace "<span style="font-style: italic;">troulliermartins</span>" by
"<span style="font-style: italic;">ultrasoft</span>" in input file)<br>A
third solution is to select a
simple
“bessel”
pseudopotential (replace "<span style="font-style: italic;">troulliermartins</span>"
by "<span style="font-style: italic;">bessel</span>" in input file).
But, in that case, one has to
noticeably decrease the matching radius <span style="font-style: italic;">r</span><sub style="font-style: italic;">Vloc</sub>
if
one wants to keep reasonable physical results. Selecting a value of <span style="font-style: italic;">r</span><sub style="font-style: italic;">Vloc</sub>
between 0.6*<span style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub> and 0.8*<span style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub>
is
a good choice; but the best way to adjust <span style="font-style: italic;">r</span><sub style="font-style: italic;">Vloc</sub>
value is to have a look at the two values of <span style="font-style: italic;">evale</span> in&nbsp;<span style="color: rgb(51, 102, 255);">Ni</span> file which
are sensitive
to the choice of <span style="font-style: italic;">r</span><sub style="font-style: italic;">Vloc</sub>. To change the
value of &nbsp;<span style="font-style: italic;">r</span><sub style="font-style: italic;">Vloc</sub>,
one has to detail the line containing all radii (<span style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub><span style="font-style: italic;"></span>, <span style="font-style: italic;">r</span><sub style="font-style: italic;">shape</sub><span style="font-style: italic;"></span>,
<span style="font-style: italic;">r</span><sub style="font-style: italic;">Vloc</sub>
and <span style="font-style: italic;">r</span><sub style="font-style: italic;">core</sub><span style="font-style: italic;"></span>);
see&nbsp;<a href="lesson_paw2/atompaw-usersguide.pdf" target="_blank">user's
guide</a>.</div></div><div style="margin-left: 40px;">* Change
the matching radius <span style="font-style: italic;">r</span><sub style="font-style: italic;">c</sub> for one (or both) <span style="font-style: italic;">l</span> partial-wave(s).
In some
cases, changing <span style="font-style: italic;">r</span><sub style="font-style: italic;">c</sub> can remove ghost
states. </div><ul><li>In
most cases (changing pseudopotential or
matching radius), one has to restart the procedure from step 5.</li></ul>To
see an example of ghost state, <span style="color: rgb(153, 0, 0);">use
the ~abinit/doc/tutorial/lesson_paw2/Ni.ghost.atompaw.input</span>
file and run it with
<span style="font-weight: bold;">ATOMPAW</span><span style="font-weight: bold;">.</span><br><span style="color: rgb(153, 0, 0);">Look
at the </span><span style="font-style: italic; color: rgb(153, 0, 0);">l</span><span style="color: rgb(153, 0, 0);">=1 logarithmic
derivatives <span style="color: black;">(</span></span><span style="color: black;">logderiv.1
file)</span>. They look
like:<br><div style="text-align: center;"><img src="lesson_paw2/log1c.jpg" alt="Ni l=1 log derivatives" style="width: 434px; height: 446px;"><br><div style="text-align: left;">Now,<span style="color: rgb(153, 0, 0);">
edit the </span><span style="color: rgb(51, 102, 255);">Ni.ghost.atompaw.input</span><span style="color: rgb(153, 0, 0);">
file and replace "<span style="font-style: italic;">troulliermartins</span>"
by "<span style="font-style: italic;">ultrasoft</span>".<span style="color: black;"> Run </span><span style="font-weight: bold; color: black;">ATOMPAW</span><span style="color: black;">
again... and look at</span> </span><span style="color: rgb(51, 102, 255);">logderiv.1</span><span style="color: black;">
file</span>. The ghost state has moved !<br><span style="color: rgb(153, 0, 0);">Edit again the file and
replace
'<span style="font-style: italic;">ultrasoft</span>" by "<span style="font-style: italic;">bessel</span>"<span style="color: black;">; then change the 17th line
("2.0 2.0 2.0 2.0")
by "2.0 2.0 1.8 2.0"</span></span>. This has the effect of decreasing
the <span style="font-style: italic;">r</span><sub style="font-style: italic;">Vloc</sub>
radius. <span style="color: rgb(153, 0, 0);"><span style="color: black;">Run </span><span style="font-weight: bold;"><span style="color: black;">ATOMPA</span>W</span></span><span style="font-weight: bold;">:</span>
the
ghost state disappears !<br><span style="color: rgb(153, 0, 0);"><span style="color: black;">Start
from
the original state of</span>&nbsp;</span><span style="color: rgb(51, 102, 255);">Ni.ghost.atompaw.input</span><span style="color: rgb(153, 0, 0);">
<span style="color: black;">file and <span style="color: rgb(153, 0, 0);">put 1.8 for the matching radius of </span></span></span><span style="font-style: italic; color: rgb(153, 0, 0);">p</span><span style="color: black;"><span style="color: rgb(153, 0, 0);">- states </span>(put 1.8
on lines 31 and 32). Run <span style="font-weight: bold;">ATOMPAW</span></span><span style="font-weight: bold;">:</span> the ghost state
disappears !<br><br><hr style="width: 100%; height: 2px;"><a name="7">&nbsp;</a>
<br><h3>7. Testing efficiency of PAW dataset</h3><span style="color: rgb(153, 0, 0);">
Let's use again our </span><span style="color: rgb(51, 102, 255);">Ni.atompaw.input1</span>
file for Nickel (with all our modifications).<br><span style="color: rgb(153, 0, 0);"></span>You
get a file <span style="color: rgb(51, 102, 255);">Ni.GGA-PBE-paw.abinit</span><span style="color: rgb(51, 102, 255);"></span>
containing the PAW dataset designated for <span style="font-weight: bold;">ABINIT</span>.<br><br>Now,
one has to test the efficiency of the generated PAW dataset. We finally
will use <span style="font-weight: bold;">ABINIT</span> !<br>You are
about to run a DFT computation and
determine the size of
the plane wave basis needed to get a given accuracy. If the cut-off
energy defining the plane waves basis is too high (higher
than 20 Hartree, if <span style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub> has a reasonable
value), some
changes have to be made in the input file.<br><br><span style="color: rgb(153, 0, 0);">Copy </span><span style="color: rgb(51, 102, 255);">~abinit/tests/tutorial/Input/tpaw2_x.files</span><span style="color: rgb(153, 0, 0);">
and </span><span style="color: rgb(51, 102, 255);">~abinit/tests/tutorial/Input/tpaw2_1.in</span><span style="color: rgb(153, 0, 0);">
in your working directory. Edit <span style="color: rgb(51, 102, 255);">~abinit/tests/tutorial/Input/tpaw2_1.in</span>, and
activate the eight datasets (only one is kept by default for testing purposes). Run <span style="font-weight: bold;">ABINIT</span>
with them.</span><br><span style="font-weight: bold;">ABINIT</span>
computes
the total energy of ferromagnetic FCC Nickel for several values of <span style="font-style: italic; font-weight: bold;">ecut</span>.<br>At
the end of output file, you get this:<br><br><span style="font-family: monospace;"></span><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut1&nbsp;&nbsp; 8.00000000E+00 Hartree<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut2&nbsp;&nbsp; 1.00000000E+01 Hartree<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut3&nbsp;&nbsp; 1.20000000E+01 Hartree<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut4&nbsp;&nbsp; 1.40000000E+01 Hartree<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut5&nbsp;&nbsp; 1.60000000E+01 Hartree<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut6&nbsp;&nbsp; 1.80000000E+01 Hartree<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut7&nbsp;&nbsp; 2.00000000E+01 Hartree</span><br><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut8&nbsp;&nbsp; 2.20000000E+01 Hartree<br>&nbsp;&nbsp;&nbsp;
etotal1&nbsp; -3.9300291581E+01<br>&nbsp;&nbsp;&nbsp; etotal2&nbsp;
-3.9503638785E+01<br>&nbsp;&nbsp;&nbsp;&nbsp;etotal3&nbsp;
-3.9583278145E+01<br>&nbsp;&nbsp;&nbsp; etotal4&nbsp; -3.9613946329E+01<br>&nbsp;&nbsp;&nbsp;&nbsp;etotal5&nbsp;
-3.9623543087E+01<br>&nbsp;&nbsp;&nbsp;&nbsp;etotal6&nbsp;
-3.9626889070E+01<br>&nbsp;&nbsp;&nbsp;&nbsp;etotal7&nbsp;
-3.9628094989E+01<br>&nbsp;&nbsp;&nbsp;&nbsp;etotal8&nbsp;
-3.9628458879E+01</span><br><br><span style="font-family: monospace;"></span><span style="font-weight: bold; font-style: italic;">etotal</span>
convergence (at 1 mHartree) is achieve for 18&lt;=<span style="font-style: italic; font-weight: bold;">ecut</span>&lt;=20
Hartree<span style="font-weight: bold; font-style: italic;"><br>etotal</span>
convergence (at 0,1 mHartree) is achieve for&nbsp;<span style="font-style: italic; font-weight: bold;">ecut</span>&gt;22
Hartree<br><br><span style="font-weight: bold;">This
is not a good
result for a PAW dataset</span>;
let's try to optimize it.<br><ul><li><span style="text-decoration: underline;">First
possibility: use Vanderbilt projectors instead of Bloechl ones</span>.</li></ul><div style="margin-left: 40px;">Vanderbilt projectors generally
are more
localized in reciprocal space
than Bloechl ones (see ref. [4] for a detailed description of
Vanderbilt projectors).<br>Keyword "<span style="font-style: italic;">bloechl</span>"
has to be replaced
by
"<span style="font-style: italic;">vanderbilt</span>" in the <span style="font-weight: bold;">ATOMPAW</span>
input file&nbsp;and <span style="font-weight: bold; font-style: italic;">r</span><sub style="font-weight: bold; font-style: italic;">c</sub>
values have to be added at the end of the file (one for each PS partial
wave).<br>You can have a look at the <span style="font-weight: bold;">ATOMPAW</span>
input file
:&nbsp; ~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input.vanderbilt<br><span style="font-style: italic;">But we will not test this case
here as it
produces problematic results for this example (see below).</span></div><ul><li><span style="text-decoration: underline;">2nd possibility: use
RRKJ
pseudization scheme for projectors</span>.</li></ul><div style="margin-left: 40px;"><span style="color: rgb(153, 0, 0);">Use
this&nbsp;input file for ATOMPAW: </span>
~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input2<span style="color: rgb(51, 102, 255);"></span><br>As
you can see (by
editing the file)<span style="font-style: italic;">&nbsp;&nbsp;“bloechl”</span>
has been changed by&nbsp;”<span style="font-style: italic;">custom
rrkj</span>” and 6 <span style="font-weight: bold; font-style: italic;">r</span><sub style="font-weight: bold; font-style: italic;">c</sub>
values have
been added at the end of the file; each one correspond to the <span style="font-weight: bold;">matching radius of one PS partial
wave</span>.<br><span style="color: rgb(153, 0, 0);">Repeat
the entire procedure (</span><span style="font-weight: bold; color: rgb(153, 0, 0);">ATOMPAW</span><span style="color: rgb(153, 0, 0);">&nbsp;</span><span style="color: rgb(153, 0, 0);">+ </span><span style="font-weight: bold; color: rgb(153, 0, 0);">ABINIT</span><span style="color: rgb(153, 0, 0);">)...</span>
and get a new <span style="font-weight: bold;">ABINIT</span> output
file.<br><span style="font-style: italic;">Note:
you have to look again at log derivatives in order to verify that they
still are correct...</span><p><span style="font-family: monospace;"><span style="font-style: italic;"></span></span></p></div><div style="margin-left: 40px;"><span style="font-family: monospace;"><span style="font-style: italic;">&nbsp;</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ecut1&nbsp;&nbsp;
8.00000000E+00 Hartree<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut2&nbsp;&nbsp; 1.00000000E+01 Hartree<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut3&nbsp;&nbsp; 1.20000000E+01 Hartree<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut4&nbsp;&nbsp; 1.40000000E+01 Hartree<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut5&nbsp;&nbsp; 1.60000000E+01 Hartree<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut6&nbsp;&nbsp; 1.80000000E+01 Hartree<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut7&nbsp;&nbsp; 2.00000000E+01 Hartree<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut8&nbsp;&nbsp; 2.20000000E+01 Hartree<br>&nbsp; &nbsp;
etotal1&nbsp; -3.9600401638E+01<br>&nbsp;&nbsp;&nbsp; etotal2&nbsp;
-3.9627563690E+01<br>&nbsp;&nbsp;&nbsp; etotal3&nbsp; -3.9627901781E+01<br>&nbsp;&nbsp;&nbsp;
etotal4&nbsp; -3.9628482371E+01<br>&nbsp;&nbsp;&nbsp; etotal5&nbsp;
-3.9628946655E+01<br>&nbsp;&nbsp;&nbsp; etotal6&nbsp; -3.9629072497E+01<br>&nbsp;&nbsp;&nbsp;
etotal7&nbsp; -3.9629079826E+01<br>&nbsp;&nbsp;&nbsp; etotal8&nbsp;
-3.9629097793E+01</span></div><div style="margin-left: 40px;"><span style="font-family: monospace;"></span></div><span style="font-family: monospace;"></span><div style="margin-left: 40px;"><span style="font-weight: bold; font-style: italic;">etotal</span>
convergence (at 1 mHartree) is achieve for 12&lt;=<span style="font-style: italic; font-weight: bold;">ecut</span>&lt;=14
Hartree<span style="font-weight: bold; font-style: italic;"><br>etotal</span>
convergence (at 0,1 mHartree) is achieve for <span style="font-style: italic;">16&lt;=</span><span style="font-style: italic; font-weight: bold;">ecut</span>&lt;=18
Hartree<br><span style="font-weight: bold;">This is
a reasonable
result for a PAW dataset</span> !<br><span style="font-family: monospace;"></span></div><span style="font-style: italic;"></span><ul><li><span style="text-decoration: underline;">3rd possibility: use
enhanced
polynomial pseudization scheme for projectors</span>.</li></ul><div style="margin-left: 40px;"><span style="color: rgb(153, 0, 0);">Edit </span>
~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input2<span style="color: rgb(51, 102, 255);"></span><span style="color: rgb(153, 0, 0);"> and replace "<span style="font-style: italic;">custom rrkj</span>" by
"<span style="font-style: italic;">custom
polynom2 7 10</span>"</span></div><div style="margin-left: 40px;"><span style="color: rgb(153, 0, 0);">Repeat
the entire procedure (</span><span style="font-weight: bold; color: rgb(153, 0, 0);">ATOMPAW</span><span style="color: rgb(153, 0, 0);"></span><span style="font-weight: bold; color: rgb(153, 0, 0);"></span><span style="color: rgb(153, 0, 0);">
+ </span><span style="font-weight: bold; color: rgb(153, 0, 0);">ABINIT</span><span style="color: rgb(153, 0, 0);">)...</span> and look at
ecut
convergence...</div><span style="font-family: monospace;">&nbsp;
&nbsp;&nbsp; </span><span style="font-weight: bold; font-style: italic;"><br><br><br>Optional
exercise: let's go back to Vanderbilt projectors</span><br><div style="margin-left: 40px;"><span style="color: rgb(153, 0, 0);">Repeat
the procedure (</span><span style="font-weight: bold; color: rgb(153, 0, 0);">ATOMPAW</span><span style="color: rgb(153, 0, 0);">
+ </span><span style="font-weight: bold; color: rgb(153, 0, 0);">ABINIT</span><span style="color: rgb(153, 0, 0);">) with </span>
 ~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input.vanderbilt
<span style="color: rgb(153, 0, 0);">file.</span><br>As
you can see
<span style="font-weight: bold;">ABINIT</span> convergence cannot be
achieved !<br>You can try whatever
you
want with radii and/or references energies in the <span style="font-weight: bold;">ATOMPAW</span> input file:
<span style="font-weight: bold;">ABINIT</span> always diverges !<br>The
solution here is to change the
pseudization scheme for the local pseudopotential.<br><span style="color: rgb(153, 0, 0);">Try to replace the
"<span style="font-style: italic;">troulliermartins</span>"
keyword by "<span style="font-style: italic;">ultrasoft</span>". Repeat
the procedure (</span><span style="font-weight: bold; color: rgb(153, 0, 0);">ATOMPAW</span><span style="color: rgb(153, 0, 0);">&nbsp;</span><span style="color: rgb(153, 0, 0);">+ </span><span style="font-weight: bold; color: rgb(153, 0, 0);">ABINIT</span><span style="color: rgb(153, 0, 0);">).</span><br><span style="color: rgb(153, 0, 0);"></span><span style="font-weight: bold;">ABINIT</span>
can now
reach&nbsp;
convergence !<br>Results are below:</div><p style="margin-left: 80px;"></p><div style="margin-left: 40px;"><span style="font-family: monospace;">&nbsp;
&nbsp;&nbsp;&nbsp;
ecut1&nbsp;&nbsp; 8.00000000E+00 Hartree</span><br><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut2&nbsp;&nbsp; 1.00000000E+01 Hartree</span><br><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut3&nbsp;&nbsp; 1.20000000E+01 Hartree</span><br><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut4&nbsp;&nbsp; 1.40000000E+01 Hartree</span><br><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut5&nbsp;&nbsp; 1.60000000E+01 Hartree</span><br><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut6&nbsp;&nbsp; 1.80000000E+01 Hartree</span><br><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut7&nbsp;&nbsp; 2.00000000E+01 Hartree</span><br><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ecut8&nbsp;&nbsp; 2.20000000E+01 Hartree</span><br><span style="font-family: monospace;">&nbsp;&nbsp;&nbsp;
etotal1&nbsp; -3.9609714395E+01<br>&nbsp;&nbsp;&nbsp; etotal2&nbsp;
-3.9615187859E+01<br>&nbsp;&nbsp;&nbsp; etotal3&nbsp; -3.9618367959E+01<br>&nbsp;&nbsp;&nbsp;
etotal4&nbsp; -3.9622476129E+01<br>&nbsp;&nbsp;&nbsp; etotal5&nbsp;
-3.9624707476E+01<br>&nbsp;&nbsp;&nbsp; etotal6&nbsp; -3.9625234480E+01<br>&nbsp;&nbsp;&nbsp;
etotal7&nbsp; -3.9625282524E+01<br>&nbsp;&nbsp;&nbsp; etotal8&nbsp;
-3.9625330757E+01</span></div><div style="margin-left: 120px;"></div><div style="margin-left: 120px;"></div><div style="margin-left: 40px;"><span style="font-family: monospace;"></span><span style="font-weight: bold; font-style: italic;"></span><span style="font-weight: bold; font-style: italic;">etotal</span>
convergence (at 1 mHartree) is achieve for 14&lt;=<span style="font-style: italic; font-weight: bold;">ecut</span>&lt;=16
Hartree<span style="font-weight: bold; font-style: italic;"></span><br><span style="font-weight: bold; font-style: italic;">etotal</span>
convergence (at 0,1 mHartree) is achieve for <span style="font-style: italic;">20&lt;=</span><span style="font-style: italic; font-weight: bold;">ecut</span>&lt;=22
Hartree<br><span style="font-style: italic;">Note:
You could have tried the "bessel" keyword instead of "ultrasoft"...</span></div><div style="text-align: left;"></div><p><span style="text-decoration: underline; font-style: italic;">Summary
of convergency results:</span></p><p><span style="text-decoration: underline; font-style: italic;"></span></p><span style="text-decoration: underline; font-style: italic;"><img alt="ecut convergence" src="lesson_paw2/ecut.jpg"></span><br><br><span style="text-decoration: underline; font-style: italic;">Final
remarks:</span><ul><ul><li style="font-style: italic;"><p style="margin-top: 0.08in; margin-bottom: 0in;" align="justify">The
localization of projectors in reciprocal space can (generally) be
predicted by a look at <span style="color: rgb(51, 102, 255);">tprod.i</span>
files. Such a file contains the curve of
as a function of q (reciprocal space variable). q is given in Bohr<sup>-1</sup>
units; it can be connected to&nbsp;<span style="font-weight: bold;">ABINIT</span>
plane waves cut-off energy
(in
Hartree units) by: ecut=q<sub>cut</sub><sup>2</sup>/4. These quantities
are only calculated for the bound
states, since the Fourier transform of an extended function is not
well-defined.</p> </li><li style="font-style: italic;"><p style="margin-top: 0.08in; margin-bottom: 0in;" align="justify">
Generating projectors with Blöchl’s scheme often
gives the guaranty to have stable calculations. atompaw ends without
any convergence problem and DFT calculations run without any divergence
(but they need high plane wave cut-off). Vanderbilt projectors (and
even more “custom” projectors) sometimes produce
instabilities during the PAW dataset generation process and/or the DFT
calculations…</p></li><li><p style="margin-top: 0.08in; margin-bottom: 0in; margin-left: 0.0366in; font-style: italic;" align="justify">In most cases, after having changed the
projector generation scheme, one has to restart the procedure from
step 5.</p></li></ul></ul><br><hr style="width: 100%; height: 2px;"><a name="8">&nbsp;</a>
<br><h3>8. Testing against physical quantities</h3> <p style="margin-bottom: 0in;" align="justify" lang="en-US">Finally,
the last step is to examine carefully
the physical quantities obtained with the PAW
dataset.<br><span style="color: rgb(153, 0, 0);"></span></p><p style="margin-bottom: 0in;" align="justify" lang="en-US"><span style="color: rgb(153, 0, 0);">Copy&nbsp;</span><span style="color: rgb(51, 102, 255);"></span><span style="color: rgb(153, 0, 0);"></span><span style="color: rgb(51, 102, 255);">~abinit/tests/tutorial/Input/tpaw2_2.in</span><span style="color: rgb(153, 0, 0);">
in your working directory. Edit it, to activate the eight datasets (instead of one). <br>Use the&nbsp; </span>
~abinit/doc/tutorial/lesson_paw2/Ni.GGA-PBE-paw.abinit.rrkj
<span style="color: rgb(153, 0, 0);">psp file&nbsp;</span>(it
has been obtained from <span style="color: rgb(51, 102, 255);">Ni.atompaw.input2</span>
file).<br><span style="color: rgb(153, 0, 0);">Modify
<span style="color: rgb(51, 102, 255);">tpaw2_x.files</span>
file according to these new files.<br>Run <span style="font-weight: bold;">ABINIT</span> (this may take a
while...).</span></p><p style="margin-bottom: 0in;" align="justify" lang="en-US"><span style="font-weight: bold;">ABINIT</span>
computes
the converged ground state of ferromagnetic FCC Nickel for several
volumes around equilibrium.</p><span style="color: rgb(153, 0, 0);">Plot
the <span style="font-style: italic;">etotal vs acell</span>
curve</span>:<br><img style="width: 434px; height: 446px;" alt="etotal vs acell" src="lesson_paw2/acell-etotal.jpg"><br>From this
graph and output file,
you can extract some physical quantities:<br><div style="margin-left: 40px;">Equilibrium cell
parameter:&nbsp;<span style="font-style: italic; font-weight: bold; color: rgb(0, 102, 0);">a</span><sub style="font-style: italic; font-weight: bold; color: rgb(0, 102, 0);">0</sub><span style="font-weight: bold; color: rgb(0, 102, 0);"> = 3.523 angstrom</span><br>Bulk
modulus: <span style="font-style: italic; color: rgb(0, 102, 0); font-weight: bold;">B</span><span style="color: rgb(0, 102, 0); font-weight: bold;"> = 190 GPa</span><br>Magnetic
moment
at equilibrium: <span style="font-weight: bold; color: rgb(0, 102, 0);">μ
= 0.60</span> </div><br>Compare these results with published results:<br><ul><li>GGA-FLAPW
(<span style="font-style: italic;">all-electrons</span> - ref [3]):</li></ul><div style="margin-left: 40px;"><div style="margin-left: 40px;"><span style="font-style: italic;">a</span><sub style="font-style: italic;">0</sub>
= 3.52 angstrom<br><span style="font-style: italic;">B</span> = 200 GPa<br>μ
= 0.60</div></div><ul><li>GGA-PAW (VASP - ref [3]):</li></ul><div style="margin-left: 40px;"><div style="margin-left: 40px;"><span style="font-style: italic;">a</span><sub style="font-style: italic;">0</sub>&nbsp;=
3.52 angstrom<br><span style="font-style: italic;">B</span> = 194 GPa<br>μ
= 0.61</div></div><ul><li>Experimental results<br>from <span style="color: rgb(51, 51, 255);">Dewaele, Torrent, Loubeyre, Mezouar.
Phys. Rev. B </span><span style="font-weight: bold; color: rgb(51, 51, 255);">78</span><span style="color: rgb(51, 51, 255);">, 104102 (2008)</span>:</li></ul><div style="margin-left: 40px;"><div style="margin-left: 40px;"><span style="font-style: italic;">a</span><sub style="font-style: italic;">0</sub>
= 3.52 angstrom<br><span style="font-style: italic;">B</span> = 183 GPa</div>
</div><p style="margin-left: 0.24in; margin-top: 0.08in; margin-bottom: 0in;" align="justify" lang="en-US"><big><span style="font-style: italic;">You
should always compare&nbsp;results with all-electrons ones (or other PAW
computations), not with experimental ones...</span></big><span style="text-decoration: underline;"></span></p><p style="margin-left: 0.24in; margin-top: 0.08in; margin-bottom: 0in;" align="justify" lang="en-US"><span style="text-decoration: underline;"></span></p><span style="text-decoration: underline;"><br>Additional
remark</span>:&nbsp;<p style="margin-left: 0.24in; margin-top: 0.08in; margin-bottom: 0in;" align="justify" lang="en-US">It can be useful to test
the sensitivity of results to some <span style="font-weight: bold;">ATOMPAW</span>
input
parameters (see <a href="lesson_paw2/atompaw-usersguide.pdf" target="_blank">user's
guide</a> for details on keywords):</p>
<ul><li>The
analytical form and the cut-off radius <span style="font-style: italic; font-weight: bold;">r</span><sub style="font-style: italic; font-weight: bold;">shape</sub> of the <span style="font-weight: bold;">shape function</span>
used in compensation charge density definition. By default a
“sinc”
function is used but “gaussian” shapes can have an
influence on results. “Bessel” shapes are efficient
and generally need a smaller cut-off radius (<span style="font-style: italic;">r</span><sub style="font-style: italic;">shape</sub>=~0.8*<span style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub>).</li><li>The
matching radius <span style="font-style: italic; font-weight: bold;">r</span><sub style="font-style: italic; font-weight: bold;">core</sub> used to get
pseudo core density from atomic core
density.</li><li><span style="color: rgb(51, 102, 102);"> The
inclusion of additional (“semi-core”) states in the set of valence
electrons</span>.</li><li>The
pseudization scheme used to get pseudopotential <span style="font-style: italic;">V</span><sub style="font-style: italic;">loc</sub><span style="font-style: italic;">(r)</span>.</li></ul> <p style="margin-left: 0.24in; margin-top: 0.08in; margin-bottom: 0in;" align="justify" lang="en-US">
All these parameters have to be meticulously checked, especially
if the PAW dataset is used for non-standard solid structures or
thermodynamical domains.</p>
<p style="margin-bottom: 0in;" align="justify" lang="en-US"><span style="font-weight: bold; font-style: italic;">Optional
exercise: let's add 3s and 3p semi-core states in PAW dataset !</span></p><div style="margin-left: 40px;"><span style="color: rgb(153, 0, 0);">Repeat
the procedure (</span><span style="font-weight: bold; color: rgb(153, 0, 0);">ATOMPAW</span><span style="color: rgb(153, 0, 0);">&nbsp;</span><span style="color: rgb(153, 0, 0);">+ </span><span style="font-weight: bold; color: rgb(153, 0, 0);">ABINIT</span><span style="color: rgb(153, 0, 0);">) with </span>
~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input.semicore
<span style="color: rgb(153, 0, 0);">file...<br><span style="color: rgb(0, 0, 0);">The run is a bit longer as more electrons
have to be treated by <span style="font-weight: bold;">ABINIT</span>.</span></span><span style="color: rgb(153, 0, 0);"><br>Look at </span><span style="font-style: italic; color: rgb(153, 0, 0);">a</span><sub style="font-style: italic; color: rgb(153, 0, 0);">0</sub><span style="color: rgb(153, 0, 0);">, </span><span style="font-style: italic; color: rgb(153, 0, 0);">B</span><span style="color: rgb(153, 0, 0);"> or&nbsp;μ variation.</span></div>
<div style="margin-left: 40px;">Note: this new PAW dataset has a
smaller
<span style="font-style: italic;">r</span><sub style="font-style: italic;">PAW</sub> radius (because semi-core states
are localized).</div><div style="margin-left: 80px;"><span style="color: rgb(153, 0, 0);"></span><span style="font-style: italic;">a</span><sub style="font-style: italic;">0</sub> = 3.519 angstrom<br><span style="font-style: italic;">B</span> = 194 GPa<br>μ = 0.60</div><br><hr style="width: 100%; height: 2px;"><a name="9">&nbsp;</a>
<br><h3>8. The Real Space Optimization (RSO) - experienced users</h3>In
this section, an additional optimization of the atomic data
is proposed which can contribute, in some cases, to an acceleration of
the convergence on&nbsp;<span style="font-style: italic;">ecut</span>.
This
optimization is not essential to produce efficient PAW&nbsp;datasets
but
it can be useful. We advise experienced users to try it.<p> The idea is
quite simple: when expressing the different atomic radial functions
(φ<sub>i</sub>,<span style="position: relative; top: -5pt; left: 6pt;">~</span>φ<sub>i</sub>,&nbsp;<span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>)
on the plane
waves basis, the number of plane waves depends on the
"locality" of these radial functions in reciprocal space.<br>In the
following reference (we suggest to read it): <span style="color: rgb(51, 51, 255);">&nbsp;R.D. King-Smith,
M.C. Payne, J.S. Lin, Phys. Rev. B </span><span style="font-weight: bold; color: rgb(51, 51, 255);">44</span><span style="color: rgb(51, 51, 255);">,
13063 (1991)</span></p>A&nbsp;method to enforce the
locality (in reciprocal space) of <span style="font-weight: bold;">projectors</span><span style="position: relative; top: -5pt; left: 6pt;">~</span><span style="font-weight: bold;">p</span><sub><span style="font-weight: bold;">i</span> </sub><span style="position: relative; top: -5pt; left: 6pt;"></span><span style="font-weight: bold;"></span>is presented:<br><div style="margin-left: 40px;">Projectors<span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>(g)
expressed in reciprocal space are
modified according to the following scheme:
</div><div style="margin-left: 40px;">The&nbsp;reciprocal space is
divided in 3 regions:
</div><div style="margin-left: 80px;">- If &nbsp;<span style="font-weight: bold; font-style: italic;">g &lt; g<sub>max</sub></span>,<span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>(g)
is unchanged
<br>- If &nbsp;<span style="font-weight: bold; font-style: italic;">g
&gt;</span> γ<span style="font-weight: bold; font-style: italic;"></span>,<span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>(g)
is set to zero
<br>- If <span style="font-style: italic; font-weight: bold;">g<sub>max</sub>&lt;
g &lt; </span>γ<span style="font-weight: bold; font-style: italic;"></span>,<span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>(g)
is modified so that&nbsp;the contribution of<span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>(r)
is
conserved&nbsp;with an error <span style="font-weight: bold; font-style: italic;">W</span> (as small as
possible).
</div><div style="margin-left: 80px;"><img style="width: 394px; height: 409px;" alt="RSO" src="lesson_paw2/RSO.png"></div><div style="margin-left: 40px;">The
above transformation of<span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>(g)
is only possible if<span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>(r)
is defined outside the augmentation sphere up to a radius <span style="font-weight: bold; font-style: italic;">R</span><sub style="font-weight: bold; font-style: italic;">0</sub> (with <span style="font-weight: bold; font-style: italic;">R</span><sub style="font-weight: bold; font-style: italic;">0</sub><span style="font-weight: bold; font-style: italic;">&gt;r</span><sub style="font-weight: bold; font-style: italic;">c</sub>).
</div><div style="margin-left: 320px;"></div>In practice we have to:
<br><div style="margin-left: 40px;">- Impose an error <span style="font-style: italic; font-weight: bold;">W</span> (<span style="font-weight: bold; font-style: italic;">W</span> is the maximum
error admitted on total energy)
<br>- Adjust <span style="font-weight: bold; font-style: italic;">g</span><sub style="font-weight: bold; font-style: italic;">max</sub> according to <span style="font-weight: bold; font-style: italic;">Ecut </span><span style="font-style: italic;"></span>(<span style="font-weight: bold; font-style: italic;">g<sub>max</sub>&lt;=
Ecut</span><span style="font-weight: bold;"></span>)
<br>- Choose <span style="font-weight: bold;">γ</span> so that <span style="font-weight: bold;">2*g</span><sub style="font-weight: bold;">max</sub><span style="font-weight: bold;"> &lt; γ &lt; 3*g</span><sub style="font-weight: bold;">max</sub>
</div>and the <span style="font-weight: bold;">ATOMPAW</span>
code
apply the transformation to<span style="position: relative; top: -5pt; left: 6pt;">~</span>p<sub>i</sub>
and deduce <span style="font-weight: bold; font-style: italic;">R</span><sub style="font-weight: bold; font-style: italic;">0</sub> radius.
<br><br>You can test it now.
<br>In your working directory, <span style="color: rgb(153, 0, 0);">re-use
the dataset with Bloechl projectors <span style="color: rgb(0, 0, 0);">(</span></span>
~abinit/doc/tutorial/lesson_paw2/Ni.atompaw.input3<span style="color: rgb(0, 0, 0);">).</span><br><span style="color: rgb(153, 0, 0);"><span style="color: rgb(0, 0, 0);">Replace
the last line but one ("<span style="font-style: italic;">default</span>")
by "<span style="font-weight: bold; font-style: italic;">rsoptim 8. 2
0.0001</span>" </span></span>(8., 2 and 0.0001 are the values for <small><span style="font-weight: bold; font-style: italic;">g</span><sub style="font-weight: bold; font-style: italic;">max</sub></small><span style="font-weight: bold; font-style: italic;"></span><span style="font-weight: bold; font-style: italic;">,&nbsp;</span><span style="font-weight: bold;">γ/</span><span style="font-weight: bold; font-style: italic;"></span><span style="font-style: italic;"></span><span style="font-weight: bold; font-style: italic;">g<sub>max</sub></span>
and
<span style="font-style: italic; font-weight: bold;">W</span>).<br><span style="color: rgb(153, 0, 0);">Run
<span style="font-weight: bold;">ATOMPAW</span>.</span><br>You
get a new psp file for <span style="font-weight: bold;">ABINIT</span>.<br><span style="color: rgb(153, 0, 0);">Run
<span style="font-weight: bold;">ABINIT</span> with it using the </span><span style="color: rgb(51, 102, 255);">~abinit/tests/tutorial/Input/tpaw2_1.in</span><span style="color: rgb(153, 0, 0);"> file</span>.<br>Compare the results
with those obtained in section 7.<br><p>You
can try several values for&nbsp;<small><span style="font-weight: bold; font-style: italic;">g</span><sub style="font-weight: bold; font-style: italic;">max</sub></small><span style="font-weight: bold; font-style: italic;"></span>
(keeping <span style="font-weight: bold;">γ/</span><span style="font-weight: bold; font-style: italic;"></span><span style="font-style: italic;"></span><span style="font-weight: bold; font-style: italic;">g<sub>max</sub></span>
and
<span style="font-style: italic; font-weight: bold;">W</span><span style="font-style: italic;"> constant)</span> and compare the
efficiency of the atomic data; do not forget to test
physical properties again.</p><p style="margin-left: 80px;"><img style="height: 446px; width: 434px;" alt="RSO comparison" src="lesson_paw2/RSOcompa.jpg"></p><p style="font-style: italic;">How
to choose the RSO parameters ?</p><div style="margin-left: 80px;"><small><span style="font-weight: bold; font-style: italic;">γ/</span></small><small><span style="font-weight: bold; font-style: italic;">g</span><sub style="font-weight: bold; font-style: italic;">max</sub></small><span style="font-weight: bold; font-style: italic;">=2</span> and <span style="font-style: italic; font-weight: bold;">0.0001 &lt; W &lt;
0.001</span> is a good choice.
<br><small><span style="font-weight: bold; font-style: italic;"></span></small><small><span style="font-weight: bold; font-style: italic;">g</span><sub style="font-weight: bold; font-style: italic;">max</sub></small><span style="font-weight: bold; font-style: italic;"></span>&nbsp;has to be
adjusted. The lower&nbsp;<small><span style="font-weight: bold; font-style: italic;">g</span><sub style="font-weight: bold; font-style: italic;">max</sub></small>&nbsp;the
faster the convergence is ; but too low&nbsp;<small><span style="font-weight: bold; font-style: italic;"></span></small><small><span style="font-weight: bold; font-style: italic;">g</span><sub style="font-weight: bold; font-style: italic;">max</sub></small><span style="font-weight: bold; font-style: italic;"></span> can produce
unphysical results.</div><p style="margin-top: 0.08in; margin-bottom: 0in;" align="justify"></p></div></div>

<h5>Copyright (C) 2005-2017 ABINIT group (MT)
<br>This file is distributed under the terms of the GNU General
Public
License, see
~abinit/COPYING or <a href="http://www.gnu.org/copyleft/gpl.txt">
http://www.gnu.org/copyleft/gpl.txt </a>.
<br>For the initials of contributors, see
~abinit/doc/developers/contributors.txt .
</h5>
<script type="text/javascript" src="list_internal_links.js"> </script>


</body></html>
